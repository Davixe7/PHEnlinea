(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3,7],{"0635":function(t,e,a){"use strict";a("681e")},"0d42":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c,a=t._self._setupProxy;return e("div",{attrs:{id:"prereg"}},[e("q-card-section",{staticClass:"flex justify-between"},[e("div",{staticStyle:{width:"42px",height:"42px"}},[e("q-btn",{directives:[{name:"show",rawName:"v-show",value:a.shouldRegister,expression:"shouldRegister"}],attrs:{flat:"",round:"",icon:"arrow_back"},on:{click:function(t){a.shouldRegister=!a.shouldRegister}}})],1),e("div",{staticClass:"text-h6 text-center flex align-items-center align-center"},[t._v("\n      Control de Visitantes\n    ")]),e("div",[e("q-btn",{attrs:{flat:"",round:"",icon:"info"}})],1)]),e("div",{staticClass:"q-pa-md"},[e("q-card",{directives:[{name:"show",rawName:"v-show",value:!a.shouldRegister&&!a.registered,expression:"!shouldRegister && !registered"}],staticClass:"flex",staticStyle:{"flex-flow":"column","max-width":"420px",margin:"50px auto"},attrs:{bordered:"",flat:""}},[e("q-card-section",[e("div",{staticClass:"text-h5 text-weight-regular text-center q-px-none"},[t._v("\n          Consultar registro\n        ")])]),e("q-card-section",{staticClass:"q-gutter-md"},[e("q-input",{ref:"InputDni",staticClass:"q-mb-md text-h5 text-center dniInput",attrs:{required:"",outlined:"","stack-label":"",type:"text",label:"Cédula"},model:{value:a.dni,callback:function(t){a.dni=t},expression:"dni"}})],1),e("q-card-actions",{staticClass:"justify-center"},[e("q-btn",{attrs:{flat:"",color:"primary"},on:{click:a.fetchVisitor}},[t._v("\n          Continuar\n        ")])],1)],1),a.shouldRegister?e(a.VisitorForm,{on:{dataSent:a.storeVisitor}}):a.registered?e("q-card",{staticClass:"registered flex column items-center",staticStyle:{"max-width":"420px",margin:"50px auto"},attrs:{bordered:"",flat:""}},[e("q-card-section",[e("q-icon",{attrs:{name:"how_to_reg",size:"100px"}})],1),e("q-card-section",{staticClass:"text-center"},[e("div",{staticClass:"text-h5 text-weight-regular"},[t._v("\n          Estimado visitante,"),e("br"),t._v("\n          Usted ya posee un registro válido.\n        ")]),e("div",{staticClass:"text q-py-md"},[t._v("\n          Puede dirigirse a porteria solo con su número de cédula.\n        ")])]),e("q-btn",{staticStyle:{width:"fit-content"},attrs:{flat:"",color:"primary"},on:{click:a.clearForm}},[t._v("\n        Listo\n      ")])],1):t._e()],1)],1)},s=[],r=a("bc3a"),n=a.n(r),o=function(){var t=this,e=t._self._c,a=t._self._setupProxy;return e("div",{attrs:{id:"visit-form"}},[a.camera?e(a.Camera,{on:{pictureTaken:a.getCameraPicture,cameraClosed:function(t){a.camera=!1}}}):t._e(),e("q-card",{attrs:{flat:"",bordered:""}},[e("q-card-section",[e("div",{staticClass:"text-h5 text-weight-regular text-center q-px-none"},[t._v("\n        Registre sus datos personales\n      ")])]),e("q-card-section",[e("div",{staticClass:"q-mb-md q-gutter-x-md"},[e("q-radio",{attrs:{dense:"",val:"singular",label:"Personal"},model:{value:a.visitor.type,callback:function(e){t.$set(a.visitor,"type",e)},expression:"visitor.type"}}),e("q-radio",{attrs:{dense:"",val:"company",label:"Empresa"},model:{value:a.visitor.type,callback:function(e){t.$set(a.visitor,"type",e)},expression:"visitor.type"}})],1),e("q-input",{ref:"InputDni",staticClass:"q-mb-md",attrs:{required:"",outlined:"","stack-label":"",type:"text",rules:a.rules.dni,label:"Cédula"},on:{blur:a.fetchVisitor},model:{value:a.visitor.dni,callback:function(e){t.$set(a.visitor,"dni",e)},expression:"visitor.dni"}}),e("q-input",{ref:"InputName",staticClass:"q-mb-md",attrs:{required:"",outlined:"","stack-label":"",type:"text",label:"Nombre",rules:a.rules.name},model:{value:a.visitor.name,callback:function(e){t.$set(a.visitor,"name",e)},expression:"visitor.name"}}),e("q-input",{ref:"InputPhone",staticClass:"q-mb-md",attrs:{outlined:"","stack-label":"",type:"text",rules:a.rules.phone,label:"Celular"},model:{value:a.visitor.phone,callback:function(e){t.$set(a.visitor,"phone",e)},expression:"visitor.phone"}}),e("q-input",{staticClass:"q-mb-md",attrs:{outlined:"","stack-label":"",type:"text",label:"Placa (opcional)"},model:{value:a.visitor.plate,callback:function(e){t.$set(a.visitor,"plate",e)},expression:"visitor.plate"}}),"company"==a.visitor.type?e("div",{staticClass:"row"},[e("div",{staticClass:"col q-pr-md"},[e("q-input",{ref:"InputCompany",staticClass:"q-mb-md",attrs:{required:"",outlined:"",type:"text",label:"Nombre de la Empresa"},model:{value:a.visitor.company,callback:function(e){t.$set(a.visitor,"company",e)},expression:"visitor.company"}})],1),e("div",{staticClass:"col q-pr-md"},[e("q-input",{staticClass:"q-mb-md",attrs:{outlined:"",type:"text",label:"ARL"},model:{value:a.visitor.arl,callback:function(e){t.$set(a.visitor,"arl",e)},expression:"visitor.arl"}})],1),e("div",{staticClass:"col"},[e("q-input",{staticClass:"q-mb-md",attrs:{outlined:"",type:"text",label:"EPS"},model:{value:a.visitor.eps,callback:function(e){t.$set(a.visitor,"eps",e)},expression:"visitor.eps"}})],1)]):t._e(),e("div",{staticClass:"row q-gutter-x-md"},[e("q-btn",{attrs:{primary:"",loading:a.loading,icon:"camera",color:"black",label:"Tomar foto"},on:{click:function(t){a.camera=!0}}}),e("q-btn",{staticClass:"q-ml-auto",attrs:{dark:"",loading:a.loading,disable:a.isInvalid||Boolean(a.visitor.id),color:"primary"},on:{click:a.storeVisit}},[t._v("\n          Registrar\n        ")])],1),t._e()],1)],1)],1)},l=[],c=a("ded3"),d=a.n(c),u=a("b817"),p=a("2b0e"),v={__name:"VisitorForm",emits:["dataSent"],setup(t,{emit:e}){const a=Object(p["b"])(!1),i=Object(p["b"])(!1),s=Object(p["b"])(!1),r=Object(p["b"])(""),o=Object(p["b"])({dni:"",name:"",phone:"",plate:"",type:"singular",company_name:"",arl:"",eps:"",picture:null}),l={dni:[t=>""!=t||"Es requerido"],name:[t=>""!=t||"Es requerido"],phone:[t=>""!=t||"Es requerido"]};function c(){n.a.get("https://phenlinea.com/api/visitors",{params:{dni:o.value.dni},headers:{Accept:"application/json","Content-Type":"application/json"}}).then((t=>o.value=d()({},t.data.data)))}function v(t){s.value=!1,o.value.picture=t}function m(){e("dataSent",h())}function h(){let t=new FormData;return Object.keys(o.value).forEach((e=>t.append(e,o.value[e]))),t}return{__sfc:!0,emit:e,isInvalid:a,loading:i,camera:s,extension_name:r,visitor:o,rules:l,fetchVisitor:c,getCameraPicture:v,storeVisit:m,loadData:h,Camera:u["default"]}}},m=v,h=a("2877"),f=a("f09f"),b=a("a370"),g=a("3786"),x=a("27f9"),q=a("9c40"),C=a("7d53"),y=a("0016"),w=a("eebe"),_=a.n(w),k=Object(h["a"])(m,o,l,!1,null,null,null),$=k.exports;_()(k,"components",{QCard:f["a"],QCardSection:b["a"],QRadio:g["a"],QInput:x["a"],QBtn:q["a"],QFile:C["a"],QIcon:y["a"]});var j={__name:"Prereg",setup(t){const e=Object(p["b"])(""),a=Object(p["b"])(!1),i=Object(p["b"])(!1);function s(){e.value="",i.value=!1,a.value=!1}function r(){n.a.get("https://phenlinea.com/api/visitors",{params:{dni:e.value},headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((t=>{t.data.data&&(i.value=!0)})).catch((t=>{t.response&&"404"==t.response.status&&(a.value=!0)}))}function o(t){n.a.post("https://phenlinea.com/api/visitors",t).then((t=>{a.value=!1,i.value=!0})).catch((t=>console.log(t.response.data)))}return{__sfc:!0,dni:e,shouldRegister:a,registered:i,clearForm:s,fetchVisitor:r,storeVisitor:o,VisitorForm:$}}},Q=j,V=(a("0635"),a("4b7e")),I=a("8572"),O=Object(h["a"])(Q,i,s,!1,null,null,null);e["default"]=O.exports;_()(O,"components",{QCardSection:b["a"],QBtn:q["a"],QCard:f["a"],QInput:x["a"],QCardActions:V["a"],QIcon:y["a"],QField:I["a"]})},"52a8":function(t,e,a){"use strict";a("80a5")},"681e":function(t,e,a){},"80a5":function(t,e,a){},b817:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"camera"}},[e("video",{ref:"video",attrs:{id:"video"},on:{canplay:t.setDimensions}}),e("div",{staticClass:"camera-actions"},[e("q-btn",{staticClass:"q-mr-md",attrs:{color:"white","text-color":"black",label:"Cancelar"},on:{click:function(e){return t.$emit("cameraClosed")}}}),e("q-btn",{attrs:{label:"Capturar",color:"primary",icon:"camera"},on:{click:t.takePicture}})],1),e("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"canvas"})])},s=[],r={name:"Camera",data(){return{width:640,height:0}},props:{fullscreen:Boolean},methods:{startVideo(){if(navigator.getMedia=navigator.getUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia,!navigator.getMedia)return;let t=this;navigator.getMedia({video:!0,audio:!1},(function(e){t.$refs.video.srcObject=e,t.$refs.video.play()}),(function(t){console.log(t)}))},setDimensions(){this.height=this.$refs.video.videoHeight/(this.$refs.video.videoWidth/this.width),this.$refs.video.width=this.width,this.$refs.video.height=this.height,this.$refs.canvas.width=this.width,this.$refs.canvas.height=this.height},takePicture(){this.$refs.canvas.getContext("2d").drawImage(this.$refs.video,0,0,this.width,this.height);let t=this;this.$refs.canvas.toBlob((function(e){t.$emit("pictureTaken",e)}))}},mounted(){this.startVideo()}},n=r,o=(a("52a8"),a("2877")),l=a("9c40"),c=a("eebe"),d=a.n(c),u=Object(o["a"])(n,i,s,!1,null,"4b1d8450",null);e["default"]=u.exports;d()(u,"components",{QBtn:l["a"]})}}]);