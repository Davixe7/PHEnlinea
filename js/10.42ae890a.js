(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"7ef9":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"autorizados"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-3 q-px-md"},[e("checkin-form")],1),e("div",{staticClass:"col-md-9 q-px-md"},[e("q-table",{staticClass:"q-mb-md",attrs:{flat:"",bordered:"",title:"Visitas de autorizados",columns:t.columns,data:t.checkins,filter:t.search,"hide-bottom":""},scopedSlots:t._u([{key:"top-right",fn:function(){return[e("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Buscar"},scopedSlots:t._u([{key:"append",fn:function(){return[e("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})]},proxy:!0}])})],1)])])},s=[],n=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"visit-form"}},[e("q-card",{attrs:{flat:"",bordered:""}},[e("q-card-section",[e("div",{staticClass:"text-h5 q-px-none"},[e("b",[t._v("Registrar visita")])])]),e("q-card-section",[e("q-select",{ref:"InputApt",staticStyle:{"margin-bottom":"20px"},attrs:{outlined:"",label:"Apartamento","use-input":"","map-options":"","option-value":"id","option-label":"name",options:t.results,required:""},on:{filter:t.filterFn},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{attrs:{name:"meeting_room"}})]},proxy:!0},{key:"no-option",fn:function(){return[e("q-item",[e("q-item-section",{staticClass:"text-grey"},[t._v("\n              Seleccione apartamento\n            ")])],1)]},proxy:!0}]),model:{value:t.visit.apartment,callback:function(e){t.$set(t.visit,"apartment",e)},expression:"visit.apartment"}}),t.visitors?e("q-list",{staticClass:"q-mb-md",attrs:{bordered:"",separator:""}},t._l(t.visitors,(function(i){return e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:i.id,attrs:{tag:"label"}},[e("q-item-section",{attrs:{side:"",top:""}},[e("q-radio",{attrs:{val:i.id},model:{value:t.visit.visitor_id,callback:function(e){t.$set(t.visit,"visitor_id",e)},expression:"visit.visitor_id"}})],1),e("q-item-section",[e("q-item-label",[t._v(t._s(i.name))]),e("q-item-label",{attrs:{caption:""}},[t._v("\n              "+t._s(i.dni)+" "+t._s(i.plate?" | Placa: "+i.plate:"")+"\n            ")])],1)],1)})),1):t._e(),e("div",{staticClass:"text-right"},[e("q-btn",{staticClass:"bg-black text-white q-ml-auto",attrs:{dark:"",loading:t.loading,disable:t.isInvalid},on:{click:t.storeCheckin}},[t._v("\n          Guardar\n        ")])],1)],1)],1)],1)},r=[],o=(i("ddb0"),{watch:{visit:{handler(){let t=this;this.visit.apartment&&this.visit.apartment&&this.visit.apartment.visitors&&(this.visitors=[...this.visit.apartment.visitors]),t.isInvalid=!this.visit.visitor_id||!this.visit.apartment},deep:!0}},computed:{apartments(){return this.$store.state.apartments.apartments},results(){return""===this.query?[...this.apartments]:this.apartments.filter((t=>t.name.toLowerCase().includes(this.query)))}},data(){return{isInvalid:!1,loading:!1,query:"",visitors:[],visit:{apartment:null,apartment_id:null,visitor_id:null}}},methods:{filterFn(t,e){this.query=t.toLowerCase(),e((()=>this.options=[...this.results]))},storeCheckin(){let t=this.loadData();this.$store.dispatch("storeCheckin",t).then((t=>this.clearForm())).catch((t=>{})).then((t=>this.loading=!1))},loadData(){this.loading=!0;let t=new FormData;return t.append("visitor_id",this.visit.visitor_id),t.append("extension_id",this.visit.apartment.id),t},clearForm(){this.visit={apartment:null,apartment_id:null,visitor_id:null};let t=this;setTimeout((function(){Object.values(t.$refs).forEach((t=>t.resetValidation()))}),1e3)}}}),l=o,c=i("2877"),d=i("f09f"),p=i("a370"),m=i("ddd8"),u=i("0016"),h=i("66e5"),v=i("4074"),f=i("1c1c"),b=i("3786"),q=i("0170"),_=i("9c40"),g=i("714f"),k=i("eebe"),x=i.n(k),C=Object(c["a"])(l,n,r,!1,null,null,null),y=C.exports;x()(C,"components",{QCard:d["a"],QCardSection:p["a"],QSelect:m["a"],QIcon:u["a"],QItem:h["a"],QItemSection:v["a"],QList:f["a"],QRadio:b["a"],QItemLabel:q["a"],QBtn:_["a"]}),x()(C,"directives",{Ripple:g["a"]});var w={components:{CheckinForm:y},data:function(){return{search:"",columns:[{name:"created_at",field:"created_at",required:!0,label:"Fecha",align:"left"},{name:"extension",field:t=>t.extension.name,required:!0,label:"Apartamento",align:"left"},{name:"visitor",field:t=>t.visitor?t.visitor.name:"cargando...",required:!0,label:"Nombre",align:"left"},{name:"dni",field:t=>t.visitor?t.visitor.dni:"cargando...",required:!0,label:"CÃ©dula",align:"left"},{name:"plate",field:t=>t.visitor&&t.visitor.plate?t.visitor.plate:"ninguna",required:!0,label:"Placa",align:"left"}]}},computed:{apartments(){return this.$store.getters.apartments?this.$store.getters.apartments:[]},checkins(){return this.$store.getters.checkins?this.$store.getters.checkins:[]}},mounted(){this.$store.dispatch("fetchApartments").then((t=>console.log(t))),this.$store.dispatch("fetchCheckins").then((t=>console.log(t[0].data)))}},Q=w,$=i("eaac"),I=i("27f9"),S=Object(c["a"])(Q,a,s,!1,null,null,null);e["default"]=S.exports;x()(S,"components",{QTable:$["a"],QInput:I["a"],QIcon:u["a"]})}}]);